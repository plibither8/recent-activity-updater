const {writeFile} = require('fs').promises
const path = require('path')
const fetch = require('node-fetch')

const saveDelta = async delta => {
	const filePath = path.join(__dirname, '../delta.json')
	await writeFile(filePath, JSON.stringify(delta))
}

// Main function
module.exports = async function(gist) {
	const gistContent = JSON.parse(Object.values(gist.data.files)[0].content)
	const oldFaves = gistContent.hackernews

	const HN_FAVES_URL = 'https://hn-faves.mihir.ch/plibither8?all=true'
	let res = {"stories": [{"id": "25600338", "title": "TabFS: Mount your Browser Tabs as a Filesystem", "link": "https://omar.website/tabfs/", "type": "story"}, {"id": "25551487", "title": "Just Wanted to Say Thanks", "link": "https://github.com/compumike/hairpin-proxy/issues/5", "type": "story"}, {"id": "25517868", "title": "How bad is your Spotify?", "link": "https://pudding.cool/2020/12/judge-my-spotify", "type": "story"}, {"id": "25415989", "title": "Google outage – resolved", "link": "https://news.ycombinator.com/item?id=25415989", "type": "story"}, {"id": "25396760", "title": "Amateur sleuths crack one of the Zodiac Killer's ciphers after 51 years", "link": "https://thehill.com/homenews/news/529929-amateur-sleuths-crack-one-of-the-zodiac-killers-ciphers-after-51-years", "type": "story"}, {"id": "25290629", "title": "Drone Footage of Arecibo Observatory Collapse", "link": "https://www.nsf.gov/news/special_reports/arecibo/", "type": "story"}, {"id": "25233136", "title": "Reveal.js: HTML presentation framework", "link": "https://revealjs.com/", "type": "story"}, {"id": "25222370", "title": "Ragya – Indian classical music played by time of the day", "link": "https://www.ragya.com/", "type": "story"}, {"id": "25149177", "title": "Beirut Port Explosion", "link": "https://forensic-architecture.org/investigation/beirut-port-explosion", "type": "story"}, {"id": "25143303", "title": "Apple's 15% Deflection Tactic", "link": "https://www.johnluxford.com/blog/apples-15-percent-deflection-tactic/", "type": "story"}, {"id": "25078034", "title": "Your Computer Isn't Yours", "link": "https://sneak.berlin/20201112/your-computer-isnt-yours/", "type": "story"}, {"id": "24886120", "title": "Show HN: Which DNS servers are you pointing to?", "link": "https://which.nameserve.rs/", "type": "story"}, {"id": "24834336", "title": "I miss Microsoft Encarta (2019)", "link": "https://www.hanselman.com/blog/i-miss-microsoft-encarta/", "type": "story"}, {"id": "24813795", "title": "We deleted the production database by accident", "link": "https://keepthescore.co/blog/posts/deleting_the_production_database/", "type": "story"}, {"id": "24718078", "title": "We Hacked Apple for 3 Months", "link": "https://samcurry.net/hacking-apple/", "type": "story"}, {"id": "24627363", "title": "Social Cooling (2017)", "link": "https://www.socialcooling.com/", "type": "story"}, {"id": "24574574", "title": "Mathematics for Programmers [pdf]", "link": "https://yurichev.com/writings/Math-for-programmers.pdf", "type": "story"}, {"id": "24541964", "title": "I no longer build software", "link": "https://github.com/docker/cli/issues/267#issuecomment-695149477", "type": "story"}, {"id": "24477941", "title": "We now consider Moment.js to be a legacy project in maintenance mode", "link": "https://momentjs.com/docs/#/-project-status/", "type": "story"}, {"id": "24401999", "title": "BitTorrent v2", "link": "https://blog.libtorrent.org/2020/09/bittorrent-v2/", "type": "story"}, {"id": "24380969", "title": "Show HN: Linux sysadmin course, eight years on", "link": "https://news.ycombinator.com/item?id=24380969", "type": "story"}, {"id": "24351073", "title": "Most-favorited Hacker News posts", "link": "https://observablehq.com/@tomlarkworthy/hacker-favourites-analysis", "type": "story"}, {"id": "12792063", "title": "Music Theory: An Education from First Principles", "link": "http://www.lightnote.co/", "type": "story"}, {"id": "20272346", "title": "Learning Synths", "link": "https://learningsynths.ableton.com/", "type": "story"}, {"id": "24256883", "title": "αcτµαlly pδrταblε εxεcµταblε", "link": "https://justine.storage.googleapis.com/ape.html", "type": "story"}, {"id": "24217116", "title": "Can't you just right click?", "link": "https://lapcatsoftware.com/articles/unsigned.html", "type": "story"}, {"id": "24106545", "title": "I tried starting a manufacturing unit in India", "link": "https://superr.in/economy/i-tried-starting-a-manufacturing-unit-in-india/", "type": "story"}, {"id": "24088582", "title": "Ask HN: Films that made you see the world differently?", "link": "https://news.ycombinator.com/item?id=24088582", "type": "story"}, {"id": "24047342", "title": "Chrome Music Lab", "link": "https://musiclab.chromeexperiments.com/Experiments", "type": "story"}, {"id": "24030969", "title": "Laws of UX", "link": "https://lawsofux.com/", "type": "story"}, {"id": "24003385", "title": "Ten modern layouts in one line of CSS", "link": "https://web.dev/one-line-layouts/", "type": "story"}, {"id": "23988269", "title": "Schemastore.org – schemas for all commonly known JSON file formats", "link": "https://www.schemastore.org/json/", "type": "story"}, {"id": "23967887", "title": "How GPT3 Works – Visualizations and Animations", "link": "https://jalammar.github.io/how-gpt3-works-visualizations-animations/", "type": "story"}, {"id": "23955527", "title": "WebGL Fluid Simulation", "link": "https://paveldogreat.github.io/WebGL-Fluid-Simulation/?play", "type": "story"}, {"id": "23948234", "title": "Show HN: Textdb.dev – simple data sharing for fun projects", "link": "https://textdb.dev", "type": "story"}, {"id": "23878980", "title": "Show HN: Cookie Recipe Generator", "link": "https://thecookie.website/", "type": "story"}, {"id": "23851275", "title": "Hackers take over prominent Twitter accounts in simultaneous attack", "link": "https://www.coindesk.com/hackers-take-over-prominent-crypto-twitter-accounts-in-simultaneous-attack", "type": "story"}, {"id": "23775404", "title": "We can't send email more than 500 miles (2002)", "link": "http://web.mit.edu/jemorris/humor/500-miles", "type": "story"}, {"id": "23771131", "title": "Show HN: Runnaroo – A new search engine", "link": "https://www.runnaroo.com/", "type": "story"}, {"id": "23543043", "title": "Drive through cities in the browser while listening to local radio stations", "link": "https://driveandlisten.herokuapp.com/", "type": "story"}, {"id": "23479435", "title": "You can bypass YouTube ads by adding a dot after the domain", "link": "https://www.reddit.com/r/webdev/comments/gzr3cq/fyi_you_can_bypass_youtube_ads_by_adding_a_dot/", "type": "story"}, {"id": "23371530", "title": "Ask HN: I'm an incoming freshman to college for a CS major, what should I know?", "link": "https://news.ycombinator.com/item?id=23371530", "type": "story"}, {"id": "23366546", "title": "Ask HN: Am I the longest-serving programmer – 57 years and counting?", "link": "https://news.ycombinator.com/item?id=23366546", "type": "story"}, {"id": "23343794", "title": "I wrote a SaaS product because the internet made me believe it'd make me rich", "link": "https://blog.stetsonblake.com/thoughts-on-learning-to-design-build-and-launch-a-saas-business/", "type": "story"}, {"id": "23309269", "title": "AWS services explained in one line each", "link": "https://adayinthelifeof.nl/2020/05/20/aws.html", "type": "story"}, {"id": "23304536", "title": "I wrote Task Manager and I just remembered something", "link": "https://old.reddit.com/r/techsupport/comments/gqb915/i_wrote_task_manager_and_i_just_remembered/", "type": "story"}, {"id": "23304614", "title": "I bought netflix.soy", "link": "https://tinyprojects.dev/posts/i_bought_netflix_dot_soy", "type": "story"}, {"id": "23224584", "title": "John Carmack is reading and contributing to OpenBSD source code", "link": "https://marc.info/?l=openbsd-tech&m=158965652915344&w=2", "type": "story"}, {"id": "23172483", "title": "Deno 1.0", "link": "https://deno.land/v1", "type": "story"}, {"id": "23165333", "title": "Show HN: SHA-256 Animation", "link": "https://github.com/in3rsha/sha256-animation", "type": "story"}, {"id": "23155177", "title": "The most prized degree in India became the most worthless", "link": "https://restofworld.org/2020/india-engineering-degree/", "type": "story"}, {"id": "23147372", "title": "John Peel Sessions", "link": "https://davestrickson.blogspot.com/2020/05/john-peel-sessions.html", "type": "story"}, {"id": "23109997", "title": "We Chat, They Watch", "link": "https://citizenlab.ca/2020/05/we-chat-they-watch/", "type": "story"}, {"id": "23101869", "title": "Show HN: Interface for all digital aspects of my life", "link": "https://beepb00p.xyz/hpi.html", "type": "story"}, {"id": "22998423", "title": "Disney claims anyone using a Twitter hashtag is agreeing to their terms of use", "link": "https://twitter.com/disneyplus/status/1254772307941191686", "type": "story"}, {"id": "22992544", "title": "Lamest Edit Wars", "link": "https://en.wikipedia.org/wiki/Wikipedia:Lamest_edit_wars", "type": "story"}, {"id": "22925087", "title": "Shirt Without Stripes", "link": "https://github.com/elsamuko/Shirt-without-Stripes", "type": "story"}, {"id": "22853847", "title": "PiHex", "link": "https://en.wikipedia.org/wiki/PiHex", "type": "story"}, {"id": "22467744", "title": "Wide Gamut Color in CSS with Display-P3", "link": "https://webkit.org/blog/10042/wide-gamut-color-in-css-with-display-p3/", "type": "story"}, {"id": "22852646", "title": "Colornames.org – A collaborative effort to name all 16.7M colors", "link": "https://colornames.org/", "type": "story"}, {"id": "22838255", "title": "Pointless", "link": "https://ptls.dev/", "type": "story"}, {"id": "22790623", "title": "WhyTheName", "link": "https://wiki.debian.org/WhyTheName", "type": "story"}, {"id": "22778123", "title": "Ask HN: What do you use to keep track of bookmarks/notes/snippets?", "link": "https://news.ycombinator.com/item?id=22778123", "type": "story"}, {"id": "22766690", "title": "Electricity as Power (1880) [pdf]", "link": "https://science.sciencemag.org/content/sci/os-1/1/5.full.pdf", "type": "story"}, {"id": "22758218", "title": "How to manage HTML DOM with vanilla JavaScript only?", "link": "https://htmldom.dev/", "type": "story"}, {"id": "22732214", "title": "An Integration Loop", "link": "https://www.robinsloan.com/notes/integration-loop/", "type": "story"}, {"id": "22719288", "title": "Show HN: Colors.lol – Overly descriptive color palettes", "link": "https://colors.lol/", "type": "story"}, {"id": "22707102", "title": "Is there any code in Firefox (as of 2020) that comes from Netscape Navigator?", "link": "https://retrocomputing.stackexchange.com/questions/14229/is-there-any-code-in-firefox-as-of-2020-that-comes-from-netscape-navigator", "type": "story"}, {"id": "22604597", "title": "ReMarkable’s redesigned e-paper tablet is more powerful and more papery", "link": "https://techcrunch.com/2020/03/17/remarkables-redesigned-e-paper-tablet-is-more-powerful-and-more-papery/", "type": "story"}, {"id": "22574603", "title": "The most surprising Unix programs", "link": "https://minnie.tuhs.org/pipermail/tuhs/2020-March/020664.html", "type": "story"}, {"id": "22579290", "title": "Corona Simulator", "link": "https://www.washingtonpost.com/graphics/2020/world/corona-simulator/", "type": "story"}, {"id": "22579598", "title": "Open letter from Italy to the international scientific community", "link": "https://left.it/2020/03/13/covid_19-open-letter-from-italy-to-the-international-scientific-community/", "type": "story"}, {"id": "22493216", "title": "The History of the URL", "link": "https://blog.cloudflare.com/the-history-of-the-url/", "type": "story"}, {"id": "22447606", "title": "Archiving Web Sites (2018)", "link": "https://lwn.net/Articles/766374/", "type": "story"}, {"id": "22448933", "title": "A half-hour to learn Rust", "link": "https://fasterthanli.me/blog/2020/a-half-hour-to-learn-rust/", "type": "story"}, {"id": "22401797", "title": "Pwn.college", "link": "https://www.pwn.college/", "type": "story"}, {"id": "22390740", "title": "Does memory leak? (1995)", "link": "https://groups.google.com/forum/message/raw?msg=comp.lang.ada/E9bNCvDQ12k/1tezW24ZxdAJ", "type": "story"}, {"id": "22364230", "title": "Principles of Icon Design", "link": "https://uxdesign.cc/7-principles-of-icon-design-e7187539e4a2", "type": "story"}, {"id": "22310813", "title": "Gears", "link": "https://ciechanow.ski/gears/", "type": "story"}, {"id": "22279051", "title": "Ask HN: What's the best resource for learning modern x64 assembly?", "link": "https://news.ycombinator.com/item?id=22279051", "type": "story"}, {"id": "22130874", "title": "Discovering Millions of Datasets on the Web", "link": "https://blog.google/products/search/discovering-millions-datasets-web/", "type": "story"}, {"id": "22094396", "title": "Variations on symmetric nearest neighbour smoothing", "link": "https://observablehq.com/@jobleonard/symmetric-nearest-neighbour-all-the-things", "type": "story"}, {"id": "22092108", "title": "Ask HN: What are the best unknown books you have read?", "link": "https://news.ycombinator.com/item?id=22092108", "type": "story"}, {"id": "22022466", "title": "Goodbye, Clean Code", "link": "https://overreacted.io/goodbye-clean-code/", "type": "story"}, {"id": "22016212", "title": "SMS is not 2FA-secure", "link": "https://www.issms2fasecure.com/", "type": "story"}, {"id": "21998638", "title": "Broot – A new way to see and navigate directory trees", "link": "https://dystroy.org/broot/", "type": "story"}, {"id": "21988968", "title": "How to Exit Vim", "link": "https://github.com/hakluke/how-to-exit-vim/blob/master/README.md", "type": "story"}, {"id": "21955306", "title": "Notes on Technical Writing", "link": "https://mkaz.blog/misc/notes-on-technical-writing/", "type": "story"}, {"id": "21927804", "title": "How I automate my home", "link": "https://japaniot.github.io/2020/01/01/how-i-automate-my-home-en/", "type": "story"}, {"id": "21919685", "title": "Immortal Game", "link": "https://en.wikipedia.org/wiki/Immortal_Game", "type": "story"}, {"id": "21900498", "title": "Ask HN: Best books you read in the past decade?", "link": "https://news.ycombinator.com/item?id=21900498", "type": "story"}, {"id": "21878292", "title": "Grumpy Website – a blog about everything wrong with modern web & tech", "link": "https://grumpy.website", "type": "story"}, {"id": "21871026", "title": "My Business Card Runs Linux", "link": "https://www.thirtythreeforty.net/posts/2019/12/my-business-card-runs-linux/", "type": "story"}, {"id": "21830277", "title": "Cliff Stoll, the mad scientist who invented the art of hunting hackers", "link": "https://www.wired.com/story/meet-the-mad-scientist-who-wrote-the-book-on-how-to-hunt-hackers/", "type": "story"}, {"id": "21822225", "title": "Ask HN: How Can I Learn Music Theory?", "link": "https://news.ycombinator.com/item?id=21822225", "type": "story"}, {"id": "21802452", "title": "Ask HN: Books you plan to read in 2020?", "link": "https://news.ycombinator.com/item?id=21802452", "type": "story"}, {"id": "21784392", "title": "Layout 101", "link": "https://docs.google.com/file/d/0B0gPtgNVonXPT1NsWGpKZWZKV1U", "type": "story"}, {"id": "21778298", "title": "How the Library of Congress Unrolled a 2000-Year-Old Buddhist Scroll", "link": "https://www.atlasobscura.com/articles/gandhara-scroll-library-of-congress", "type": "story"}, {"id": "21766781", "title": "API Practices If You Hate Your Customers", "link": "https://queue.acm.org/detail.cfm?ref=rss&id=3375635", "type": "story"}, {"id": "21745740", "title": "Things end users care about but programmers don't", "link": "https://instadeq.com/blog/posts/things-end-users-care-about-but-programmers-dont/", "type": "story"}, {"id": "21728436", "title": "Ask HN: What mistakes did you make when starting as a consultant/freelancer?", "link": "https://news.ycombinator.com/item?id=21728436", "type": "story"}, {"id": "21719575", "title": "Show HN: Space Invaders in C", "link": "http://blog.loadzero.com/blog/si78c/", "type": "story"}, {"id": "21703345", "title": "Fight back against Google AMP (2018)", "link": "https://www.polemicdigital.com/google-amp-go-to-hell/", "type": "story"}, {"id": "21676252", "title": "The world needs more search engines", "link": "https://www.0x65.dev/blog/2019-12-01/the-world-needs-cliqz-the-world-needs-more-search-engines.html", "type": "story"}, {"id": "21655958", "title": "Firefox Replay", "link": "https://firefox-replay.com/", "type": "story"}, {"id": "21611677", "title": "Save .org", "link": "https://savedotorg.org/", "type": "story"}, {"id": "21563355", "title": "Ask HN: Best Noise Canceling Headphones", "link": "https://news.ycombinator.com/item?id=21563355", "type": "story"}, {"id": "21543377", "title": "Which answer in this list is the correct answer to this question? (2017)", "link": "https://math.stackexchange.com/questions/2217248/which-answer-in-this-list-is-the-correct-answer-to-this-question", "type": "story"}, {"id": "21501720", "title": "Falsehoods CS Students (Still) Believe Upon Graduating", "link": "https://www.netmeister.org/blog/cs-falsehoods.html", "type": "story"}, {"id": "21439659", "title": "ShareDrop – P2P File Transfer Using WebRTC", "link": "https://sharedrop.io", "type": "story"}, {"id": "21431071", "title": "Spleeter: Extract voice, piano, drums, etc. from any music track", "link": "https://github.com/deezer/spleeter", "type": "story"}, {"id": "21355575", "title": "Airbnb in the Himalayas", "link": "https://veridici.com/how-airbnb-is-silently-changing-himalayan-villages/", "type": "story"}, {"id": "21346500", "title": "How to Become the Best in the World at Something", "link": "https://forge.medium.com/how-to-become-the-best-in-the-world-at-something-f1b658f93428", "type": "story"}, {"id": "21332072", "title": "Ask HN: Successful one-person online businesses?", "link": "https://news.ycombinator.com/item?id=21332072", "type": "story"}, {"id": "21234753", "title": "Bullshit.js", "link": "https://mourner.github.io/bullshit.js/", "type": "story"}, {"id": "21202905", "title": "Ken Thompson's Unix Password", "link": "https://leahneukirchen.org/blog/archive/2019/10/ken-thompson-s-unix-password.html", "type": "story"}, {"id": "21181015", "title": "Web Graphics Done Right", "link": "https://evilmartians.com/chronicles/images-done-right-web-graphics-good-to-the-last-byte-optimization-techniques", "type": "story"}, {"id": "21151646", "title": "Karatsuba Algorithm", "link": "https://en.wikipedia.org/wiki/Karatsuba_algorithm", "type": "story"}, {"id": "21120637", "title": "Cargo Cult Science (1974)", "link": "http://calteches.library.caltech.edu/51/2/CargoCult.htm", "type": "story"}, {"id": "21119553", "title": "HEAD – A guide to <head> elements", "link": "https://htmlhead.dev/", "type": "story"}, {"id": "21037167", "title": "Show HN: See a Satellite Tonight. No Telescope Required", "link": "https://james.darpinian.com/satellites/", "type": "story"}, {"id": "21028361", "title": "ColorBox by Lyft Design", "link": "https://www.colorbox.io", "type": "story"}, {"id": "21005704", "title": "The cost of parsing JSON", "link": "https://v8.dev/blog/cost-of-javascript-2019#json", "type": "story"}, {"id": "20985875", "title": "The boring technology behind a one-person Internet company (2018)", "link": "https://broadcast.listennotes.com/the-boring-technology-behind-listen-notes-56697c2e347b", "type": "story"}, {"id": "20870326", "title": "USB4 Specification", "link": "https://www.usb.org/document-library/usb4tm-specification", "type": "story"}, {"id": "20829715", "title": "Reasons Not to Use Google (2015)", "link": "https://stallman.org/google.html", "type": "story"}, {"id": "20751074", "title": "A Primer on Bézier Curves (2013)", "link": "https://pomax.github.io/bezierinfo/", "type": "story"}, {"id": "20726906", "title": "Start Your Own ISP", "link": "https://startyourownisp.com/", "type": "story"}, {"id": "20670432", "title": "Paged Out – a new experimental magazine about programming", "link": "https://pagedout.institute", "type": "story"}, {"id": "20627274", "title": "History of the broken vertical bar, being the ¦ form of |", "link": "https://www.reddit.com/r/typography/comments/aqcesg/history_of_the_broken_vertical_bar_being_the_form/", "type": "story"}, {"id": "20643052", "title": "The Lonely Work of Moderating Hacker News", "link": "https://www.newyorker.com/news/letter-from-silicon-valley/the-lonely-work-of-moderating-hacker-news", "type": "story"}, {"id": "20624576", "title": "Turning a MacBook into a Touchscreen with $1 of Hardware (2018)", "link": "https://www.anishathalye.com/2018/04/03/macbook-touchscreen/", "type": "story"}, {"id": "20616055", "title": "8chan goes dark after hardware provider discontinues service", "link": "https://www.theverge.com/2019/8/5/20754943/8chan-epik-offline-voxility-service-cutoff-hate-speech-ban", "type": "story"}, {"id": "20615019", "title": "There is no evil like reCAPTCHA", "link": "https://thestoic.me/there-is-no-evil-like-recaptcha", "type": "story"}, {"id": "20598907", "title": "Punpedia – The Online Encyclopedia of Puns", "link": "https://punpedia.org/", "type": "story"}, {"id": "20611390", "title": "Rust Language Cheat Sheet", "link": "https://cheats.rs/", "type": "story"}, {"id": "20608032", "title": "Regex for Noobs – An Illustrated Guide", "link": "https://www.janmeppe.com/blog/regex-for-noobs/", "type": "story"}, {"id": "20603567", "title": "Build Your Own Text Editor", "link": "https://viewsourcecode.org/snaptoken/kilo/index.html", "type": "story"}, {"id": "20600878", "title": "ZipCPU – A small, lightweight, RISC soft core in Verilog", "link": "https://github.com/ZipCPU/zipcpu", "type": "story"}, {"id": "20550034", "title": "Survival in chessland [pdf]", "link": "http://tom7.org/chess/survival.pdf", "type": "story"}, {"id": "20566779", "title": "Technician keeps computer made in 1959 still humming along", "link": "http://www.asahi.com/ajw/articles/AJ201907280007.html", "type": "story"}, {"id": "20453241", "title": "What every computer science major should know (2011)", "link": "http://matt.might.net/articles/what-cs-majors-should-know/", "type": "story"}, {"id": "20344565", "title": "User Inyerface – A worst-practice UI experiment", "link": "https://userinyerface.com", "type": "story"}, {"id": "20343728", "title": "Why did moving the mouse cursor cause Windows 95 to run more quickly?", "link": "https://retrocomputing.stackexchange.com/questions/11533/why-did-moving-the-mouse-cursor-cause-windows-95-to-run-more-quickly", "type": "story"}, {"id": "20344244", "title": "Ask HN: What are some fun projects to try out on a spare Linux file server?", "link": "https://news.ycombinator.com/item?id=20344244", "type": "story"}, {"id": "20309311", "title": "Microsoft's Linux Kernel", "link": "https://github.com/microsoft/WSLv2-Linux-Kernel", "type": "story"}, {"id": "20294523", "title": "Why are the username and password on two different pages?", "link": "https://www.twilio.com/blog/why-username-and-password-on-two-different-pages", "type": "story"}, {"id": "20292638", "title": "Show HN: A Firefox extension to leave comments on any URL", "link": "https://github.com/comntr/webext", "type": "story"}, {"id": "20295694", "title": "Reinventing Firefox for Android", "link": "https://blog.mozilla.org/futurereleases/2019/06/27/reinventing-firefox-for-android-a-preview/", "type": "story"}, {"id": "20294801", "title": "Google’s new reCAPTCHA has a dark side", "link": "https://www.fastcompany.com/90369697/googles-new-recaptcha-has-a-dark-side", "type": "story"}, {"id": "20297435", "title": "Welcome to the Old Internet Again", "link": "http://theoldnet.com/", "type": "story"}, {"id": "20264911", "title": "Ask HN: What do you do with your Raspberry Pi?", "link": "https://news.ycombinator.com/item?id=20264911", "type": "story"}, {"id": "20226506", "title": "This Marketing Blog Does Not Exist", "link": "http://thismarketingblogdoesnotexist.com/", "type": "story"}, {"id": "20210791", "title": "Facebook reveals its cryptocurrency Libra", "link": "https://decrypt.co/7502/facebook-libra-coin-cryptocurrency-launch-calibra", "type": "story"}, {"id": "20196061", "title": "Relearn CSS layout", "link": "https://every-layout.dev/", "type": "story"}, {"id": "20168936", "title": "An Infinitely Large Napkin", "link": "http://web.evanchen.cc/napkin.html", "type": "story"}, {"id": "20135047", "title": "PracticeJS – Coding exercises in a mobile friendly web app", "link": "https://practicejs.com/", "type": "story"}, {"id": "20112207", "title": "Inventors killed by their own inventions", "link": "https://en.wikipedia.org/wiki/List_of_inventors_killed_by_their_own_inventions", "type": "story"}, {"id": "20103589", "title": "I've been building a Markdown note-taking app for 3 years", "link": "https://blog.inkdrop.info/introducing-inkdrop-4-9d0c63de16d2", "type": "story"}, {"id": "20110442", "title": "Open Source Game Clones", "link": "https://osgameclones.com/", "type": "story"}, {"id": "20103540", "title": "Firefox Monitor", "link": "https://monitor.firefox.com/scan", "type": "story"}, {"id": "18743465", "title": "Ask HN: Favorite nonfiction books of 2018?", "link": "https://news.ycombinator.com/item?id=18743465", "type": "story"}, {"id": "20088870", "title": "Zero Rupee Note", "link": "https://en.wikipedia.org/wiki/Zero_rupee_note", "type": "story"}, {"id": "20086045", "title": "Apple Sign In", "link": "https://techcrunch.com/2019/06/03/apple-sign-in-privacy/", "type": "story"}, {"id": "20062902", "title": "Ways to travel at nearly the speed of light", "link": "https://phys.org/news/2019-05-ways.html", "type": "story"}, {"id": "20060074", "title": "A Most Important Discovery (1953)", "link": "http://lettersofnote.com/2015/07/a-most-important-discovery.html", "type": "story"}, {"id": "20041252", "title": "Birthday Paradox Revisited", "link": "http://datagenetics.com/blog/february72019/index.html", "type": "story"}, {"id": "20052931", "title": "Google – My Location History", "link": "https://www.google.com/maps/timeline?authuser=0&pb", "type": "story"}, {"id": "20048205", "title": "Mathematics all-in-one cheat-sheet (2013) [pdf]", "link": "https://ourway.keybase.pub/mathematics_cheat_sheet.pdf", "type": "story"}, {"id": "20039891", "title": "Falsehoods Programmers Believe About Search", "link": "https://opensourceconnections.com/blog/2019/05/29/falsehoods-programmers-believe-about-search/", "type": "story"}, {"id": "18073169", "title": "Ask HN: What podcasts do you listen to regularly?", "link": "https://news.ycombinator.com/item?id=18073169", "type": "story"}, {"id": "17532094", "title": "Ask HN: Favorite note-taking software?", "link": "https://news.ycombinator.com/item?id=17532094", "type": "story"}, {"id": "20015775", "title": "Ask HN: How do I make sure my non-technical parents are safe online?", "link": "https://news.ycombinator.com/item?id=20015775", "type": "story"}, {"id": "20012687", "title": "Show HN: nextdns.io – A Combination of Cloudflare DNS and Pi-Hole", "link": "https://www.nextdns.io/", "type": "story"}, {"id": "20008396", "title": "Please don’t theme our apps", "link": "https://stopthemingmy.app/", "type": "story"}, {"id": "20006062", "title": "Show HN: Uranus – Memo and Task App", "link": "https://github.com/resotto/uranus", "type": "story"}, {"id": "19980257", "title": "Mathematicians revive abandoned approach to the Riemann Hypothesis", "link": "https://phys.org/news/2019-05-mathematicians-revive-abandoned-approach-riemann.html", "type": "story"}, {"id": "19998806", "title": "The shittiest project I ever worked on (2013)", "link": "https://blog.plover.com/tech/prudential.html", "type": "story"}, {"id": "19968114", "title": "Five Hundred and Seven Mechanical Movements (1908)", "link": "http://507movements.com", "type": "story"}, {"id": "19967982", "title": "Set Theory and Foundations of Mathematics", "link": "http://settheory.net/", "type": "story"}, {"id": "19969321", "title": "I don't know how CPUs work so I simulated one in code", "link": "https://djhworld.github.io/post/2019/05/21/i-dont-know-how-cpus-work-so-i-simulated-one-in-code/", "type": "story"}, {"id": "19964431", "title": "Notes on Weight Initialization for Deep Neural Networks", "link": "https://madaan.github.io/init/", "type": "story"}, {"id": "19945984", "title": "My Git Workflow (2008)", "link": "https://blog.osteele.com/2008/05/my-git-workflow/", "type": "story"}, {"id": "19935648", "title": "The struggles of an open source maintainer", "link": "http://antirez.com/news/129", "type": "story"}, {"id": "19927266", "title": "I turned my interview task for Google into a startup", "link": "https://uxdesign.cc/i-turned-my-interview-task-for-google-into-a-startup-877943fb3b34", "type": "story"}, {"id": "19852105", "title": "Css-only-chat: A truly monstrous async web chat using no JS on the front end", "link": "https://github.com/kkuchta/css-only-chat", "type": "story"}, {"id": "19888493", "title": "Humane by Design", "link": "https://humanebydesign.com/", "type": "story"}, {"id": "19876710", "title": "Show HN: WildDuck – Self-hosted modern email server", "link": "https://wildduck.email/", "type": "story"}, {"id": "19881709", "title": "GitHub Package Registry", "link": "https://github.com/features/package-registry", "type": "story"}, {"id": "19867401", "title": "The Beauty of Calculus [video]", "link": "https://frankeprogram.yale.edu/event/steven-strogatz-lecture-april-26-2019", "type": "story"}, {"id": "19879513", "title": "C++ UI Libraries", "link": "https://philippegroarke.com/posts/2018/c++_ui_solutions/", "type": "story"}, {"id": "19858015", "title": "Show HN: CSSFX – Click-to-copy CSS effects", "link": "https://cssfx.dev/", "type": "story"}, {"id": "19856419", "title": "HTTP headers for the responsible developer", "link": "https://www.twilio.com/blog/a-http-headers-for-the-responsible-developer", "type": "story"}, {"id": "19871207", "title": "Why are 2D vector graphics so much harder than 3D?", "link": "https://blog.mecheye.net/2019/05/why-is-2d-graphics-is-harder-than-3d-graphics/", "type": "story"}, {"id": "19877811", "title": "Git rebase in depth", "link": "https://git-rebase.io", "type": "story"}, {"id": "19850656", "title": "Performance of nnn vs. ls", "link": "https://github.com/jarun/nnn/wiki/performance", "type": "story"}, {"id": "19845776", "title": "Open source collaborative text editors", "link": "https://juretriglav.si/open-source-collaborative-text-editors/", "type": "story"}, {"id": "19834132", "title": "Flashrom – flash BIOS/EFI/coreboot/firmware/optionROM and expansion cards", "link": "https://www.flashrom.org/Flashrom", "type": "story"}, {"id": "19829460", "title": "The Cassowary: World’s most dangerous bird (2016)", "link": "https://www.smithsonianmag.com/science-nature/behind-scenes-national-zoo-worlds-most-dangerous-bird-180960704/", "type": "story"}, {"id": "19822100", "title": "The Problem With Happiness", "link": "https://athenaeumreview.org/essay/the-problem-with-happiness/", "type": "story"}, {"id": "19826379", "title": "Show HN: Komiser – Detect potential AWS cost savings", "link": "https://github.com/mlabouardy/komiser", "type": "story"}, {"id": "19818078", "title": "Show HN: Working on a new network transport for PulseAudio and ALSA", "link": "https://gavv.github.io/articles/new-network-transport/#", "type": "story"}, {"id": "19806169", "title": "What is the largest bi-truncatable prime?", "link": "https://www.primepuzzles.net/puzzles/puzz_950.htm", "type": "story"}, {"id": "19811715", "title": "Self Studying the MIT Applied Math Curriculum", "link": "https://www.harshsikka.me/self-studying-the-mit-applied-math-curriculum/", "type": "story"}, {"id": "19813607", "title": "Android App Reverse Engineering 101", "link": "https://maddiestone.github.io/AndroidAppRE/", "type": "story"}, {"id": "19798678", "title": "A Conspiracy to Kill IE6", "link": "http://blog.chriszacharias.com/a-conspiracy-to-kill-ie6", "type": "story"}, {"id": "19791208", "title": "Apollo 15 postage stamp incident", "link": "https://en.wikipedia.org/wiki/Apollo_15_postage_stamp_scandal", "type": "story"}, {"id": "19794558", "title": "Intermediate Vim", "link": "https://dn.ht/intermediate-vim/", "type": "story"}, {"id": "19790912", "title": "Golden: Mapping human knowledge", "link": "https://golden.com/blog/introducing-golden/", "type": "story"}, {"id": "19788465", "title": "Anatomy of an ELF executable", "link": "https://kishuagarwal.github.io/life-of-a-binary.html", "type": "story"}, {"id": "19787186", "title": "Yubikey guide for Git Signing, SSH Auth, U2F 2FA, and 1Password (2017)", "link": "http://www.engineerbetter.com/blog/yubikey-all-the-things/", "type": "story"}, {"id": "19783650", "title": "I Can’t Answer Standardized Test Questions About My Own Poems (2017)", "link": "https://www.huffpost.com/entry/standardized-tests-are-so-bad-i-cant-answer-these_b_586d5517e4b0c3539e80c341", "type": "story"}, {"id": "19784907", "title": "Have a personal web site", "link": "https://writing.markchristian.org/2019/04/29/personal-web-sites/?c=1", "type": "story"}, {"id": "19780387", "title": "Topics in Advanced Data Structures [pdf]", "link": "http://web.stanford.edu/class/cs166/handouts/100%20Suggested%20Final%20Project%20Topics.pdf", "type": "story"}, {"id": "19756110", "title": "Ask HN: Personal photo library recommendations? Open source, browser-based", "link": "https://news.ycombinator.com/item?id=19756110", "type": "story"}, {"id": "19774997", "title": "Ask HN: Are you put off building something because it already exists?", "link": "https://news.ycombinator.com/item?id=19774997", "type": "story"}, {"id": "19764916", "title": "The Riemann Hypothesis, explained (2016)", "link": "https://medium.com/cantors-paradise/the-riemann-hypothesis-explained-fa01c1f75d3f", "type": "story"}, {"id": "19756123", "title": "Much of the “science” used in design is bullshit (2014)", "link": "http://mjparnell.com/bullshit_science_ux_design/", "type": "story"}, {"id": "19730799", "title": "Relearning Matrices as Linear Functions", "link": "https://www.dhruvonmath.com/2018/12/31/matrices/", "type": "story"}, {"id": "19704486", "title": "Commit messages guide", "link": "https://github.com/RomuloOliveira/commit-messages-guide", "type": "story"}, {"id": "19696604", "title": "Ikonate – fully customisable and accessible vector icons", "link": "https://www.ikonate.com", "type": "story"}, {"id": "19687398", "title": "I found two identical packs of Skittles among 468 packs", "link": "https://possiblywrong.wordpress.com/2019/04/06/follow-up-i-found-two-identical-packs-of-skittles-among-468-packs-with-a-total-of-27740-skittles/", "type": "story"}, {"id": "19653875", "title": "Web Developer's Guide to DNS", "link": "https://rjzaworski.com/2019/04/the-web-developers-guide-to-dns", "type": "story"}, {"id": "19590109", "title": "Capture and Decode FM Radio", "link": "https://witestlab.poly.edu/blog/capture-and-decode-fm-radio/", "type": "story"}, {"id": "19576092", "title": "You Are Not Google (2017)", "link": "https://blog.bradfieldcs.com/you-are-not-google-84912cf44afb", "type": "story"}, {"id": "19555633", "title": "Editor.js – Block Styled Editor", "link": "https://editorjs.io/", "type": "story"}, {"id": "19532643", "title": "Show HN: Tinytetris – 80 x 23 Terminal Tetris", "link": "https://github.com/taylorconor/tinytetris", "type": "story"}, {"id": "19520122", "title": "Have you been faked?", "link": "https://havetheyfaked.me/", "type": "story"}, {"id": "19513912", "title": "The World’s Cheapest Hospital Has to Get Even Cheaper", "link": "https://www.bloomberg.com/news/features/2019-03-26/the-world-s-cheapest-hospital-has-to-get-even-cheaper", "type": "story"}, {"id": "19501501", "title": "Ask HN: Those who moved careers from the US to India, what's your experience?", "link": "https://news.ycombinator.com/item?id=19501501", "type": "story"}, {"id": "19490573", "title": "A guide to difficult conversations", "link": "https://medium.dave-bailey.com/the-essential-guide-to-difficult-conversations-41f736e63ccf", "type": "story"}, {"id": "19492091", "title": "Sum-of-Three-Cubes Problem Solved for ‘Stubborn’ Number 33", "link": "https://www.quantamagazine.org/sum-of-three-cubes-problem-solved-for-stubborn-number-33-20190326/", "type": "story"}, {"id": "19485609", "title": "Name It, and They Will Come", "link": "https://overreacted.io/name-it-and-they-will-come/", "type": "story"}, {"id": "19483123", "title": "How India’s massive 2019 election will work", "link": "https://qz.com/1570687/how-indias-massive-2019-election-will-work/", "type": "story"}, {"id": "19483313", "title": "Golden Rules for Making Money (1880)", "link": "http://www.fourmilab.ch/etexts/www/barnum/moneygetting/moneygetting.html", "type": "story"}, {"id": "19483628", "title": "Nobody wants to read your shit (2009)", "link": "https://stevenpressfield.com/2009/10/writing-wednesdays-2-the-most-important-writing-lession-i-ever-learned/", "type": "story"}, {"id": "19477845", "title": "India’s data labellers are powering the global AI race", "link": "https://factordaily.com/indian-data-labellers-powering-the-global-ai-race/", "type": "story"}, {"id": "19477868", "title": "Mathigon – an interactive, personalized mathematics textbook", "link": "https://mathigon.org/", "type": "story"}, {"id": "19474292", "title": "Essential Image Optimization", "link": "https://images.guide/", "type": "story"}, {"id": "19475273", "title": "KaTeX – Fast math typesetting library for the web", "link": "https://katex.org/", "type": "story"}, {"id": "19438826", "title": "Rules for Autocomplete", "link": "http://jeremymikkola.com/posts/2019_03_19_rules_for_autocomplete.html", "type": "story"}, {"id": "19413436", "title": "Thinkpad X210", "link": "https://geoff.greer.fm/2019/03/04/thinkpad-x210/", "type": "story"}, {"id": "19412420", "title": "Famous Transcendental Numbers", "link": "http://sprott.physics.wisc.edu/Pickover/trans.html", "type": "story"}, {"id": "19367850", "title": "Firefox Send: Free encrypted file transfer service", "link": "https://blog.mozilla.org/blog/2019/03/12/introducing-firefox-send-providing-free-file-transfers-while-keeping-your-personal-information-private/", "type": "story"}, {"id": "19216428", "title": "Show HN: ICONSVG – Customize and Generate Common SVG Icons", "link": "https://iconsvg.xyz/", "type": "story"}, {"id": "19087418", "title": "Ask HN: What books changed the way you think about almost everything?", "link": "https://news.ycombinator.com/item?id=19087418", "type": "story"}, {"id": "19084773", "title": "Floating Point Visually Explained (2017)", "link": "http://fabiensanglard.net/floating_point_visually_explained/index.php", "type": "story"}], "comments": [{"id": "25507123", "link": "https://news.ycombinator.com/item?id=25507123", "user": "znpy", "type": "comment"}, {"id": "25279544", "link": "https://news.ycombinator.com/item?id=25279544", "user": "acid__", "type": "comment"}, {"id": "25225612", "link": "https://news.ycombinator.com/item?id=25225612", "user": "njanirudh", "type": "comment"}, {"id": "25080811", "link": "https://news.ycombinator.com/item?id=25080811", "user": "emptysongglass", "type": "comment"}, {"id": "24922848", "link": "https://news.ycombinator.com/item?id=24922848", "user": "artagnon", "type": "comment"}, {"id": "24246477", "link": "https://news.ycombinator.com/item?id=24246477", "user": "nickelpro", "type": "comment"}, {"id": "24205885", "link": "https://news.ycombinator.com/item?id=24205885", "user": "sjv", "type": "comment"}, {"id": "23886788", "link": "https://news.ycombinator.com/item?id=23886788", "user": "ipnon", "type": "comment"}, {"id": "23225080", "link": "https://news.ycombinator.com/item?id=23225080", "user": "londons_explore", "type": "comment"}, {"id": "23113046", "link": "https://news.ycombinator.com/item?id=23113046", "user": "ejflick", "type": "comment"}, {"id": "22732164", "link": "https://news.ycombinator.com/item?id=22732164", "user": "iandanforth", "type": "comment"}, {"id": "22634301", "link": "https://news.ycombinator.com/item?id=22634301", "user": "ccktlmazeltov", "type": "comment"}, {"id": "22108540", "link": "https://news.ycombinator.com/item?id=22108540", "user": "pushcx", "type": "comment"}, {"id": "21902127", "link": "https://news.ycombinator.com/item?id=21902127", "user": "w1ntermute", "type": "comment"}, {"id": "21773991", "link": "https://news.ycombinator.com/item?id=21773991", "user": "paulcarroty", "type": "comment"}, {"id": "21578545", "link": "https://news.ycombinator.com/item?id=21578545", "user": "iamnothere", "type": "comment"}, {"id": "21013618", "link": "https://news.ycombinator.com/item?id=21013618", "user": "liquidise", "type": "comment"}, {"id": "20873387", "link": "https://news.ycombinator.com/item?id=20873387", "user": "burnte", "type": "comment"}, {"id": "20226778", "link": "https://news.ycombinator.com/item?id=20226778", "user": "ajna91", "type": "comment"}, {"id": "18743988", "link": "https://news.ycombinator.com/item?id=18743988", "user": "shawnps", "type": "comment"}, {"id": "19088692", "link": "https://news.ycombinator.com/item?id=19088692", "user": "MikeCapone", "type": "comment"}, {"id": "19089091", "link": "https://news.ycombinator.com/item?id=19089091", "user": "3minus1", "type": "comment"}, {"id": "19786633", "link": "https://news.ycombinator.com/item?id=19786633", "user": "sametmax", "type": "comment"}, {"id": "19590709", "link": "https://news.ycombinator.com/item?id=19590709", "user": "CalChris", "type": "comment"}, {"id": "19513450", "link": "https://news.ycombinator.com/item?id=19513450", "user": "metaloha", "type": "comment"}]}
	// const currentFaveIds = await fetch(HN_FAVES_URL)
		// .then(res => res.json())
		res = Object.values(res).flat();
	const currentFaveIds = res.map(item => Number(item.id))
	console.log('done: hacker news faves')

	// Remove _removed_ favorited items
	const currentList = oldFaves.filter(item1 => currentFaveIds.find(item2 => item1.id === item2))
	const addedItems = currentFaveIds.filter(item1 => !oldFaves.find(item2 => item1 === item2.id))

	const delta = {
		added: addedItems.length,
		removed: oldFaves.length - currentList.length
	}

	// number of items removed + added
	console.log('hn faves delta:', delta.added + delta.removed)

	// write deltas to file for notify.js
	await saveDelta(delta)

	const HN_API_URL = 'http://hn.algolia.com/api/v1/items'

	let count = 1
	for (const [index, item] of addedItems.entries()) {
		await new Promise(r => setTimeout(r, 1000))
		const details = await fetch(`${HN_API_URL}/${item}`).then(res => res.json())
		addedItems[index] = {
			id: details.id,
			link: details.url || 'https://news.ycombinator.com/item?id=' + details.id,
			time: details.created_at_i * 1000,
			text: details.text,
			type: details.type,
			title: details.title
		}
		console.log(`done item: ${count++} / ${addedItems.length}`)
	}
	console.log('done: hacker news fave dates')

	const updatedFaves = [
		...currentList,
		...addedItems
	]

	// sort comments and stories by time
	updatedFaves.sort((a, b) => a.time < b.time ? 1 : -1)

	return updatedFaves
}
